<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<!-- ==========================================================  -->
<!-- Configuration for ibatis sqlmap mapping.                    -->
<!-- ==========================================================  -->

<!-- ============================================================================= -->
<!-- This file is generated by <tt>gateway-dalgen</tt>, a DAL (Data Access Layer) -->
<!-- code generation utility specially developed for <tt>gateway</tt> project.    -->
<!--                                                                               -->
<!-- PLEASE DO NOT MODIFY THIS FILE MANUALLY, or else your modification may be     -->
<!-- OVERWRITTEN by someone else. To modify the file, you should go to directory   -->
<!-- <tt>app/dalgen</tt>, and find the corresponding configuration files.          -->
<!-- Modify those files according to your needs, then run                          -->
<!-- <tt>gateway-dalgen</tt> to generate this file.                               -->
<!--                                                                               -->
<!-- ============================================================================= -->

<sqlMap namespace="gateway">

    <!-- result maps for database table gateway_interface -->
    <resultMap id="RM-INTERFACE"
               class="com.github.loadup.components.gateway.plugin.repository.database.dal.dataobject.InterfaceDO">
        <result property="tenantId" column="tenant_id" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="interfaceId" column="interface_id" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="interfaceName" column="interface_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="url" column="url" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="integrationUrl" column="integration_url" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="securityStrategyCode" column="security_strategy_code" javaType="java.lang.String"
                jdbcType="VARCHAR"/>
        <result property="version" column="version" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="type" column="type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="status" column="status" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="interfaceRequestParser" column="interface_request_parser" javaType="java.lang.String"
                jdbcType="TEXT"/>
        <result property="integrationRequestHeaderAssemble" column="integration_request_header_assemble"
                javaType="java.lang.String" jdbcType="TEXT"/>
        <result property="integrationRequestBodyAssemble" column="integration_request_body_assemble"
                javaType="java.lang.String" jdbcType="TEXT"/>
        <result property="integrationResponseParser" column="integration_response_parser" javaType="java.lang.String"
                jdbcType="TEXT"/>
        <result property="interfaceResponseHeaderAssemble" column="interface_response_header_assemble"
                javaType="java.lang.String" jdbcType="TEXT"/>
        <result property="interfaceResponseBodyAssemble" column="interface_response_body_assemble"
                javaType="java.lang.String" jdbcType="TEXT"/>
        <result property="communicationProperties" column="communication_properties" javaType="java.lang.String"
                jdbcType="VARCHAR"/>
        <result property="gmtCreate" column="gmt_create" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="gmtModified" column="gmt_modified" javaType="java.util.Date" jdbcType="TIMESTAMP"/>

    </resultMap>

    <!-- ============================================= -->
    <!-- mapped statements for IbatisInterfaceDAO -->
    <!-- ============================================= -->

    <!-- mapped statement for IbatisInterfaceDAO.insert -->
    <insert id="MS-INTERFACE-INSERT">
        <![CDATA[
        INSERT com.github.loadup.components.gateway INTO gateway_interface (tenant_id, interface_id, interface_name, url, integration_url, security_strategy_code, version, type, status, interface_request_parser, integration_request_header_assemble, integration_request_body_assemble, integration_response_parser, interface_response_header_assemble, interface_response_body_assemble, communication_properties, gmt_create, gmt_modified) VALUES (#tenantId#, #interfaceId#, #interfaceName#, #url#, #integrationUrl# , #securityStrategyCode#, #version#, #type#, #status#, #interfaceRequestParser# , #integrationRequestHeaderAssemble#, #integrationRequestBodyAssemble#, #integrationResponseParser#, #interfaceResponseHeaderAssemble#, #interfaceResponseBodyAssemble# , #communicationProperties#, #gmtCreate#, #gmtModified#)
    ]]>
    </insert>

    <!-- mapped statement for IbatisInterfaceDAO.update -->
    <update id="MS-INTERFACE-UPDATE">
        update com.github.loadup.components.gateway gateway_interface
        set interface_name = #interfaceName#, url = #url#, security_strategy_code = #securityStrategyCode#, status =
        #status#,
        integration_response_parser = #integrationResponseParser#, integration_request_header_assemble =
        #integrationRequestHeaderAssemble#,
        integration_request_body_assemble = #integrationRequestBodyAssemble#, communication_properties =
        #communicationProperties#,
        gmt_modified = #gmtModified#, interface_request_parser = #interfaceRequestParser#,
        interface_response_body_assemble = #interfaceResponseBodyAssemble#, interface_response_header_assemble =
        #interfaceResponseHeaderAssemble#
        where interface_id = #interfaceId# and version = #version#
        <dynamic prepend=" and tenant_id = ">
            <isNotEmpty property="tenantId">
                #tenantId#
            </isNotEmpty>
        </dynamic>
    </update>

    <!-- mapped statement for IbatisInterfaceDAO.loadByInterfaceId -->
    <select id="MS-INTERFACE-LOAD-BY-INTERFACE-ID" resultMap="RM-INTERFACE">
        select com.github.loadup.components.gateway tenant_id, interface_id, interface_name, url,
        integration_url, security_strategy_code, version, type, status, interface_request_parser,
        integration_request_header_assemble, integration_request_body_assemble, integration_response_parser,
        interface_response_header_assemble, interface_response_body_assemble, communication_properties, gmt_create,
        gmt_modified
        from gateway_interface
        where interface_id = #interfaceId#
    </select>

    <!-- mapped statement for IbatisInterfaceDAO.lockByInterfaceId -->
    <select id="MS-INTERFACE-LOCK-BY-INTERFACE-ID" resultMap="RM-INTERFACE">
        select com.github.loadup.components.gateway tenant_id, interface_id, interface_name, url,
        integration_url, security_strategy_code, version, type, status, interface_request_parser,
        integration_request_header_assemble, integration_request_body_assemble, integration_response_parser,
        interface_response_header_assemble, interface_response_body_assemble, communication_properties, gmt_create,
        gmt_modified
        from gateway_interface
        where interface_id = #interfaceId# for update
    </select>

    <!-- mapped statement for IbatisInterfaceDAO.lock -->
    <select id="MS-INTERFACE-LOCK" resultMap="RM-INTERFACE">
        select com.github.loadup.components.gateway tenant_id, interface_id, interface_name, url, integration_url,
        security_strategy_code, version, type, status, interface_request_parser, integration_request_header_assemble,
        integration_request_body_assemble, integration_response_parser, interface_response_header_assemble,
        interface_response_body_assemble, communication_properties, gmt_create, gmt_modified
        from gateway_interface
        where type = #type# and url = #url# and tenant_id = #tenantId# for update
    </select>

    <!-- mapped statement for IbatisInterfaceDAO.loadAll -->
    <select id="MS-INTERFACE-LOAD-ALL" resultMap="RM-INTERFACE">
        select com.github.loadup.components.gateway tenant_id, interface_id, interface_name, url, integration_url,
        security_strategy_code, version, type, status, interface_request_parser, integration_request_header_assemble,
        integration_request_body_assemble, integration_response_parser, interface_response_header_assemble,
        interface_response_body_assemble, communication_properties, gmt_create, gmt_modified
        from gateway_interface
    </select>

    <!-- mapped statement for IbatisInterfaceDAO.delete -->
    <delete id="MS-INTERFACE-DELETE">
        <![CDATA[
        DELETE com.github.loadup.components.gateway FROM gateway_interface WHERE interface_id = #interfaceId#
    ]]>
    </delete>

    <!-- mapped statement for IbatisInterfaceDAO.loadByPage -->
    <select id="MS-INTERFACE-LOAD-BY-PAGE" resultMap="RM-INTERFACE">
        select com.github.loadup.components.gateway b.tenant_id, b.interface_id, b.interface_name, b.url,
        b.integration_url, b.security_strategy_code, b.version, b.type, b.status, b.interface_request_parser,
        b.integration_request_header_assemble, b.integration_request_body_assemble, b.integration_response_parser,
        b.interface_response_header_assemble, b.interface_response_body_assemble, b.communication_properties,
        b.gmt_create, b.gmt_modified
        from gateway_interface b
        LEFT JOIN gateway_inst_interface_map m
        on b.interface_id = m.interface_id
        where 1 = 1
        <dynamic>
            <isNotEmpty property="tenantId" prepend="and">
                b.tenant_id = #tenantId#
            </isNotEmpty>
            <isNotEmpty property="interfaceId" prepend="and">
                b.interface_id = #interfaceId#
            </isNotEmpty>
            <isNotEmpty property="clientId" prepend="and">
                m.client_id = #clientId#
            </isNotEmpty>
            <isNotEmpty property="type" prepend="and">
                b.type = #type#
            </isNotEmpty>
            <isNotEmpty property="status" prepend="and">
                b.status = #status#
            </isNotEmpty>
            <isNotEmpty property="interfaceName" prepend="and">
                b.interface_name LIKE CONCAT(#interfaceName#, '%')
            </isNotEmpty>
            <isNotEmpty property="offset">
                limit #offset#, #rowcount#
            </isNotEmpty>
        </dynamic>
    </select>

</sqlMap>